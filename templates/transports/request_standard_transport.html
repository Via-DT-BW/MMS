{% extends 'home.html' %}
{% block content %}

<head>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <link href="static/plat_static/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <!-- Custom styles for this template -->
    <link href="static/plat_static/css/sb-admin-2.min.css" rel="stylesheet">
    <!-- Custom styles for this page -->
    <link href="static/plat_static/vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="static/bootstrap-select//dist/css/bootstrap-select.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="static/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <!-- (Optional) Latest compiled and minified JavaScript translation files -->
    <script src="static/bootstrap-select/dist/js/i18n/defaults-pt_PT.min.js"></script>
    <style type="text/css">
    .row {
        font-size: 14px;
    }

    .col {
        font-size: 14px;
    }
    </style>
</head>

<body style="background-color:#f8f9fc">
    <div class="container">
        <div class="card shadow mb-2 m-2">
            <div class="card-header py-3">
                <div class="row" style="text-align: center;">
                    <h2><strong>Standard Transport Request</strong></h2>
                </div>
            </div>
            <div class="card-body ">
                <div style="margin-top:10px">
                    <!--  FLASH MENSAGENS!-->
                    {% with messages = get_flashed_messages(with_categories=true,category_filter=["error","info","success","warning"]) %}
                    {% if messages %}
                    {% for category,message in messages %}
                    {% if category == 'warning' %}
                    <div class="alert alert-warning" role="alert">
                        <span>{{ message }}</span>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    {% elif category == 'info' %}
                    <div class="alert alert-info" role="alert">
                        <span>{{ message }}</span>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    {% elif category == 'success' %}
                    <div class="alert alert-success" role="alert">
                        <span>{{ message }}</span>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    {% elif category == 'error' %}
                    <div class="alert alert-danger" role="alert">
                        <span>{{ message }}</span>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    {% endif %}
                    {% endfor %}
                    {% endif %}
                    {% endwith %}
                </div>
                <form action="/add_standard_requisition" method="POST">
                    <br>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="row">
                                <h4>PickUp Company / Client </h4>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <br>
                                        <select id="t1" class="selectpicker" data-live-search="true" name="var_1" required>
                                            <option value="">Please select</option>
                                            {% for row in morada_fornecedores %}
                                            <option value="{{row.2}}">{{row.2}}</option>
                                            {% endfor %}
                                        </select>
                                        <br>
                                        <label style="margin-top:10px; font-size: 18px;">Info:</label>
                                        <select id="t2" required style="width:400px;height: 30px;margin-top:5px" disabled>
                                            {% for row in morada_fornecedores %}
                                            <option value="{{row.2}}" data-parent="{{row.2}}">Street: {{row.4}} | Country: {{row.5}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row">
                                <h4>Delivery Client / Company </h4>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <br>
                                        <select id="s1" class="selectpicker" data-live-search="true" required name="var_2">
                                            <option value="">Please select</option>
                                            {% for row in morada_fornecedores %}
                                            <option value="{{row.2}}">{{row.2}}</option>
                                            {% endfor %}
                                        </select>
                                        <br>
                                        <label style="margin-top:10px; font-size: 18px;">Info:</label>
                                        <select id="s2" required style="width:400px;height: 30px;margin-top:5px" disabled>
                                            {% for row in morada_fornecedores %}
                                            <option value="{{row.2}}" data-parent="{{row.2}}">Street: {{row.4}} | Country: {{row.5}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Datas  -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="control-label">Pick Up Date</label>
                                <div>
                                    <input type="date" name="var_7" class="form-control" required>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="control-label">Delivery Date</label>
                                <div>
                                    <input type="date" name="var_8" class="form-control" required>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Descrição Paletes  -->
                    <div class="row">
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="control-label">Nº Palettes</label>
                                <div>
                                    <input type="number" name="var_9" class="form-control" placeholder="Units" required>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="control-label">Length</label>
                                <div>
                                    <input type="number" name="var_10" class="form-control" placeholder="cm" required>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="control-label">Width</label>
                                <div>
                                    <input type="number" name="var_11" class="form-control" placeholder="cm" required>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="control-label">Height</label>
                                <div>
                                    <input type="number" name="var_12" class="form-control" placeholder="cm" required>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="control-label">Total Weight</label>
                                <div>
                                    <input type="number" name="var_13" class="form-control" placeholder="kgs" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                            <div class="form-group">
                                <label class="control-label">Quantity</label>
                                <div>
                                    <input type="number" name="noparts" class="form-control" placeholder="Qty." required>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="control-label">Stackable</label>
                                <select class="form-control" type="text" name="var_133" id="var_133" required>
                                    <option value=""> Select:</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                        </div>
                    </div>
                    <!-- Referencias  -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="row">
                                <label class="control-label">References / Description</label>
                                <div>
                                    <input type="text" name="var_15" class="form-control" placeholder="Example 1: E5463" required>
                                </div>
                            </div>
                            <div class="row">
                                <div>
                                    <input type="text" name="var_16" class="form-control" placeholder="Example 2: E123456">
                                </div>
                            </div>
                            <div class="row">
                                <div>
                                    <input type="text" name="var_17" class="form-control" placeholder="Example 3: E1234">
                                </div>
                            </div>
                            <div class="row">
                                <div>
                                    <input type="text" name="var_177" class="form-control" placeholder="Example 4: E4321">
                                </div>
                            </div>
                            <div class="row">
                                <div>
                                    <input type="text" name="var_1778" class="form-control" placeholder="Example 5: E564">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label">Imputable Bw</label>
                                        <select class="form-control" type="text" name="var_18" id="var_18" required placeholder="coisas">
                                            <option value=""> Select:</option>
                                            <option value="Borgwarner">Borgwarner</option>
                                            <option value="Client">Client</option>
                                            <option value="Supplier">Supplier</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label">Supplier/Client</label>
                                        <div>
                                            <input type="text" name="var_19" class="form-control" placeholder="Ex: Borgwarner">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label">Transport Type</label>
                                        <select class="form-control" type="text" name="var_25" id="var_25">
                                            <option value="">Select:</option>
                                            <option value="Air">Air</option>
                                            <option value="Rail">Rail</option>
                                            <option value="Sea">Sea</option>
                                            <option value="Truck">Truck</option>
                                            <option value="Van">Van</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="control-label">Product Line</label>
                                    <select class="form-control" type="text" name="var_20" id="var_20" required>
                                        <option value="">Select:</option>
                                        {% for row in cost_center %}
                                        <option value="{{row.5}}">{{row.5}} - {{row.2}} </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Partner Contact Name </label>
                            <div>
                                <input name="var_24" class="form-control" placeholder="Partner name" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="control-label">Partner Contact Email</label>
                                    <div>
                                        <input name="var_242" type="email" class="form-control" placeholder="email@something.com" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="control-label">Partner Contact Phone</label>
                                    <div>
                                        <input name="var_243" class="form-control" placeholder=" +351 258 249 200" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <label class="control-label">In system ?</label>
                            <select class="form-control" type="text" name="insystem" id="insystem" required onchange="displaysfesaso()">
                                <option value="">Select:</option>
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                            </select>
                        </div>
                        <div id="selectioninsytem" style="display:none">
                            <div class="row">
                                <div class="col-md-4">
                                    <label class="control-label">SFE Number <a href="https://borgwarner.sharepoint.com/sites/5001239/SFE/_layouts/15/FormServer.aspx?XsnLocation=/sites/5001239/SFE/SFEForms/Forms/template.xsn">Link SFE </a></label>
                                    <div>
                                        <input name="SFE" class="form-control" placeholder="SFE">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <label class="control-label">SO / SA</label>
                                    <div>
                                        <input name="sosa" class="form-control" placeholder="SO or SA">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <label class="control-label">Observations</label>
                            <div>
                                <textarea name="var_23" class="form-control" rows="2" placeholder="Maximum of 500 characters.." required></textarea>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="container">
                        <button type="submit" class="btn btn-primary btn-block" style="background-color:#007dc3;border-color:#007dc3;">Create Requisition</button>
                    </div>
                </form>
                <br>
            </div>
            <script type="text/javascript">
                var s2Clone;

                // Doesn't work in older IEs
                //CLone the Dependant drop down and hide
                document.addEventListener('DOMContentLoaded', function() {
                    s2Clone = document.getElementById("s2").cloneNode(true);
                    document.getElementById("s2").innerHTML = "";
                }, false);

                document.getElementById("s1").onchange = function() {
                    var selected = this.value;
                    var selected2 = this.value;

                    //Get the nodes with a parent attribute of the selected data
                    var optionsToInsert = s2Clone.querySelectorAll("[data-parent='" + selected + "']");
                    //clear existing
                    var s2 = document.getElementById("s2");
                    s2.innerHTML = "";

                    //Add The new  options.
                    for (i = 0; i < optionsToInsert.length; i++) {
                        s2.appendChild(optionsToInsert[i]);
                    }


                }
            </script>
            <script type="text/javascript">
                var t2Clone;

                // Doesn't work in older IEs
                //CLone the Dependant drop down and hide
                document.addEventListener('DOMContentLoaded', function() {
                    t2Clone = document.getElementById("t2").cloneNode(true);
                    document.getElementById("t2").innerHTML = "";
                }, false);

                document.getElementById("t1").onchange = function() {
                    var selected = this.value;
                    var selected2 = this.value;

                    //Get the nodes with a parent attribute of the selected data
                    var optionsToInsert = t2Clone.querySelectorAll("[data-parent='" + selected + "']");
                    //clear existing
                    var t2 = document.getElementById("t2");
                    t2.innerHTML = "";

                    //Add The new  options.
                    for (i = 0; i < optionsToInsert.length; i++) {
                        t2.appendChild(optionsToInsert[i]);
                    }


                }
            </script>
            <script>
                function displaysfesaso() {
    const selectioninsytem = document.getElementById('selectioninsytem');
    const insystem = document.getElementById('insystem');
    const sfeInput = document.querySelector('input[name="SFE"]');
    const sosaInput = document.querySelector('input[name="sosa"]');

    if (insystem.value == 'Yes') {
        selectioninsytem.style.display = 'block';

        // Set validation function for at least one field to be not empty
        sfeInput.addEventListener('input', validateFields);
        sosaInput.addEventListener('input', validateFields);
        validateFields(); // Initial validation
    } else {
        selectioninsytem.style.display = 'none';

        // Remove event listeners when the selection is 'No'
        sfeInput.removeEventListener('input', validateFields);
        sosaInput.removeEventListener('input', validateFields);
    }

    function validateFields() {
        const isSfeEmpty = sfeInput.value.trim() === '';
        const isSosaEmpty = sosaInput.value.trim() === '';

        // Set custom validity based on the validation
        sfeInput.setCustomValidity(isSfeEmpty && isSosaEmpty ? 'At least one field is required' : '');
        sosaInput.setCustomValidity(isSfeEmpty && isSosaEmpty ? 'At least one field is required' : '');
    }
}
            </script>
</body>
{% endblock %}